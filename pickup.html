<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="js/kiosk.js"></script>
<script type="text/javascript" src="js/main.js"> </script>
<meta http-equiv="content-type" content="text/html; charset=utf-8">

<link rel="stylesheet" href="css/pickup.css" type="text/css">
<link rel="shortcut icon" href="#">

<title>Pick up</title>

<script type="text/javascript">

    let sKiosk = initKopaKiosk();
    let sLocker = initLocker();

    let sReturnDate = "";

    function pickUpNextItem()
    {
        let tCurrentList = StackedList.getItemList();
        let tActiveItem = tCurrentList.pickUpNextItem();

        // All items returned, switch to next page
        if (tActiveItem === null)
        {
            debugger;
            UIGoToPage("thankyou", {returnDate: sReturnDate});
            return;
        }

        sReturnDate = Translator.getDate(Kiosk.getReturnDate(tActiveItem));
        sLocker.watchDoorStatus(tActiveItem.itemId, pickUpNextItem);
    }


    addLoadEvent(function() {
        let tList = StackedList.createLockerList("itemList", true);

        sLocker.loadMap()
                .then(pMap => {
                    tList.setLockerMap(pMap);
                    pickUpNextItem();
                })
    });

</script>
</head>

<body>
<div class="small header">
    <div class="language">EN</div>
    <div class="logout" id="header-logout">Log out</div>
</div>
<div class="content">
    <div class="title">Borrow</div>
    <div id="selected"></div>
    <div id="itemList"></div>
</div>

<div class="footer gray">
    <a href="borrow.html" class="left-link">Need help?</a>
</div>

</body>

</html> 